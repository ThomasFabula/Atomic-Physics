?a?CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCaCa
C?PROGRAMM NAME = EICH.FORaCa?C *** PROGRAMM ZUR AUSWERTUNG VON SCHREIBERAUFNA
HMENaCaCa C DAS PROGRAMM BERECHNET  AUS DEN POSITIONEN DER EICHMARKEN EINEa?C 
SPLINEFUNKTION UND BERECHNET ANSCHLIESSEND DIE FREQUENZEN DERa?C EINGEGEBENEN LI
NIEN.DABEI SIND DIE POSITIONEN DER EICHMARKEN BZW.a?C DER LINIEN IN ZENTIMETER A
NZUGEBEN , DA DAS PROGRAMM EINEN ABLESE-a
C FEHLER VON EINEM MILLIMETER ANNIMT.a
CaC EINGABE FORMATEaCaC?ZEILENNR.
POS?FORMAT?GROESSE??BEMERKUNGaCaC1
??1-80?10A8??TEXT?UEBERSCHRIFTaC2?1-8?F8.3FSR??IN MHZaC2??9-16?F8.3
??DFSR"aC2?17-20I4??INULL?NR DER LINIE DIaC?NULL GESETZT WEaC??SOLLa
C2?21-28?F8.2??OFFSET?VERSCHIEBUNG EIaC?MARKEN VOR MESSaCaC3?1-8?F
8.2?EICHPOS??IN CMaC3??9-12I4??NEICH?ANZAHL DER EICHaC?EN DIE UEBERSPRa
C??WURDENaC3?13-16I4?EICHEND?STEHT IN DIESERaC?SPALTEN EINE ZAaC?SO
 IST DIE EICHaC?EINGABE BEENDETaCaC4?1-8?F8.2??LINIENPOS??IN CMaC4??9
-12I4??LINIENEND?ENTSP.  EICHENDaC4?13-20A8??LINIEN BEZaCaCaC?ES KO
ENNEN BELIEBIG VIELE DATENSAETZE HINTEREINANDER EINGEGEBEN WEaCaCa?CCCCCCCCCCC
CCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCCgIMPLICIT REAL * 8
  (A-H,O-Z),INTEGER * 4 (I-M )g?REAL * 8 LINE(100,3)g?DIMENSION AUXARR(7,510),WY
(501),A(501),B(501),C(501),D(501)g
DIMENSION EICH(501,2),TEXT(10),AUX(4)gDIMENS
ION X(100),Y(100),YY(100),YF(100)gEQUIVALENCE (LINE(1),YY(1)),(LINE(101),YF(1))
g?EQUIVALENCE (EICH(1),X(1)),(EICH(502),Y(1))a1FORMAT(10A8)a2
FORMAT(2F8.3,
I4,F8.2)a3FORMAT(F8.2,2I4)a4FORMAT(F8.2,I4,A8)a100FORMAT('1')a101FOR
MAT(' ',10A8)a102?FORMAT(' ',2('  ',F8.3),'  ',I4,'  ',F8.2)a103?FORMAT(' ',
'  ',F8.2,2('  ',I4))a104?FORMAT('',F8.2,'  ',I4,'
?',A8)a105FORMAT(' ',9
X,'<*** EINGABE FEHLER ***>',/,/)a106?FORMAT(' ',12X,'DIE ANZAHL DER EINGEGEBE
NEN EICHMARKEN/LINIEN 'f?*,'UEBERSCHREITET DAS ERLAUBTE MAXIMUM',/,/)a109?FORM
AT ('1',9X,'AUSGABE DER ERMITTELTEN FREQUENZEN DER',f*' SPLINE ANPASSUNG',10X,'
FSR=',F8.3,' MHZ',10X,'DFSR=',F8.3,f*' MHZ',/,/)a110?FORMAT(10X,10A8,/,/)a11
1?FORMAT('+',T30,F8.2)a119?FORMAT ('1',9X,'AUSGABE DER ERMITTELTEN FREQUENZEN
 DES',f*' SPLINE-FIT',10X,'FSR=',F8.3,' MHZ',10X,'DFSR=',F8.3,f*' MHZ',/,/)a1
20FORMAT(10X,' NR.',8X,'??BEZ  ',8X,'FREQUENZ(MHZ)',f?*8X,'FREQUENZ(FSR)')a13
0FORMAT(10X,I4,8X,A8,8X,F12.2,8X,F12.4)a140
FORMAT(10X,I4,A8,/,/)a150FORM
AT(' ')a160?FORMAT(10X,'EINE LINIE LIEGT AUSSERHALB DES EICHMARKENBEREICHES',f
?*/,/)a170FORMAT(10X,'NX IST KLEINER ALS 2',/,/)a180?FORMAT(10X,'INPUT IST 
NICHT SORTIERT',/,/)a190?READ(5,1,ERR=2300,END=2300)(TEXT(I),I=1,10)gWRITE(6,
100)gWRITE(6,101)(TEXT(I),I=1,10)gREAD(5,2) FSR,DFSR,INULL,OFFSETgWRITE(6,102
) FSR,DFSR,INULL,OFFSETg?MAXL=100g?MAXE=500gI=0g?IJ=0a1000  I=I+1g?READ(5,3,ER
R=1010,END=1010) EICH(I,1),IHELP,IENDg?WRITE(6,103) EICH(I,1),IHELP,IENDg?IF(I.G
T.1)WRITE(6,111)EICH(I,1)-EICH(I-1,1)gIJ=IJ+IHELPgEICH(I,2)=I+IJg?IF(IEND.NE.0
) GOTO 1020g?IF(I.LT.MAXE) GOTO 1000a1010  WRITE(6,105)gWRITE(6,106)g?STOPa10
20  IEICH=IgWRITE(6,150)gWRITE(6,150)gI=0a1030  I=I+1g?READ(5,4,ERR=1010,END
=1035) LINE(I,1),IEND,LINE(I,3)g
WRITE(6,104) LINE(I,1),IEND,LINE(I,3)gIF (IEND
.NE.0) GOTO 1040gIF (I.LT.MAXL) GOTO 1030g?GOTO 1010a1035  I=I-1a1040  ILINE=
IgHELP=EICH(1,1)gDO 1050 I=1,IEICHa1050  EICH(I,1)=EICH(I,1)-HELPgDO 1060 I=
1,ILINEa
1060  LINE(I,1)=LINE(I,1)-HELP-OFFSETgIF ((INULL.LE.0).OR.(INULL.GT.IL
INE)) INULL=1gWYY=.1*(Y(IEICH)-Y(1))/(X(IEICH)-X(1))gHELP=IEICH*WYY*WYYgDO 20
00 I=1,IEICHa2000  WY(I)=1.0D0g?CALL DCUSP(1,IEICH,510,HELP,X,Y,WY,A,B,C,D,ICTR
L,AUXARR)gIF (ICTRL.EQ.-1) WRITE (6,2010)a
2010  FORMAT('1 FEHLER IN DCUSP',/,/
)g
WRITE(6,119) FSR,DFSRgWRITE(6,110)(TEXT(I),I=1,10)gWRITE(6,2020)a2020  FOR
MAT(10X,' NR.',8X,'?BEZ  ',f?*8X,'FREQUENZ(MHZ)',10X,'FEHLER(MHZ)',8X,'FREQUENZ
(FSR)',/)gDO 2200 I=1,ILINEgDO 2100 J=1,IEICHgIF (X(J).GT.YY(I)) GOTO 2110a2
100  CONTINUEa2110  J=J-1gH=YY(I)-X(J)g?YF(I)=((D(J)*H+C(J))*H+B(J))*H+A(J)a2
200  CONTINUEgHELP=YF(INULL)gDO 2205 I=1,ILINEgYF(I)=YF(I)-HELPgH=YF(I)*FSRg
?DYF=DSQRT((FSR*WYY*2)**2+(YF(I)*DFSR)**2)g
WRITE(6,2030) I,LINE(I,3),H,DYF,YF(I
)a2030  FORMAT(10X,I4,8X,A8,8X,F12.2,8X,F12.6,8X,F12.5)a2205  CONTINUEgWRITE(
6,2210)a2210  FORMAT('1',10X,'AUSGABE DER SPLINEKOEFFIZIENTEN',/,/,/)gWRITE(6,
2212)a2212  FORMAT(' ',14X,'A',14X,'B',14X,'C',14X,'D',/,/)a2213  FORMAT(6X,8(
5X,F10.6))gDO 2215 I=1,IEICHg?WRITE(6,2213) A(I),B(I),C(I),D(I)a2215  CONTINUE
gGOTO190a2300  CONTINUEg?STOPgEND?                                           
                                                                                                           